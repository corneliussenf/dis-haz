Circularit = 0,
Elongation = 0,
artifical = 0,
area = 0,
patchdensity = 0,
forest = 0,
Elevation = 0,
Melton = 0,
extent = 0,
type = c(quantile(data_model$type, 0.05), quantile(data_model$type, 0.95)))  # viele EZGs haben Pulisty kleiner als -1
predictions <- final_models[[2]] %>%
posterior_linpred(., newdata = response_disturbance, transform = TRUE)
response_disturbance[, "mean"] <- apply(predictions, 2, mean)
response_disturbance[, "sd"] <- apply(predictions, 2, sd)
p_response_fst <- response_disturbance %>%
mutate(type = factor(type, labels =  c("Press", "Pulse"))) %>%
split(.$type) %>%
map(~ data.frame(count = 1:2,
prop = dpois(x = 1:2, lambda = .$mean / length(1986:2018)),
prop_lwr = dpois(x = 1:2, lambda = (.$mean - .$sd) / length(1986:2018)),
prop_upr = dpois(x = 1:2, lambda = (.$mean + .$sd) / length(1986:2018)))) %>%
bind_rows(.id = "type") %>%
mutate(count = factor(count, labels =  c("One event", "Two events"))) %>%
mutate(type = factor(type, levels =  c("Press", "Pulse"))) %>%
ggplot(., aes(x = type, y = prop)) +
geom_bar(stat = "identity", position = "dodge",  width = 1) +
geom_errorbar(aes(ymin = prop_lwr, ymax = prop_upr), position = position_dodge(width = 0.9), width = 0.25) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
plot.title = element_text(size = 11)) +
labs(x = "Number of events", y = bquote("Probability of occurrence (%"*yr^-1*")"),
fill = "Disturbance type", title = "b) Flood") +
scale_fill_brewer(palette = "Set1") +
facet_wrap(~count, scales = "free") +
guides(fill = guide_legend(ncol = 1,
keywidth = 0.15,
keyheight = 0.1,
default.unit = "inch")) +
scale_y_continuous(labels = function(x) round(x * 100, 3))
p_response <- p_response_dfl + p_response_fst + plot_layout(ncol = 2)
p_response
p_response
p_response
response_disturbance <- expand.grid(eco_region = factor(1),
h_mean = 0,
Circularit = 0,
Elongation = 0,
artifical = 0,
area = 0,
patchdensity = 0,
forest = 0,
Elevation = 0,
Melton = 0,
extent = c((0.5 - mean(data$extent)) / sd(data$extent),
(0.1 - mean(data$extent)) / sd(data$extent)),
type = c(quantile(data_model$type, 0.05), quantile(data_model$type, 0.95)))  # viele EZGs haben Pulisty kleiner als -1
predictions <- final_models[[1]] %>%
posterior_linpred(., newdata = response_disturbance, transform = TRUE)
response_disturbance[, "mean"] <- apply(predictions, 2, mean)
response_disturbance[, "sd"] <- apply(predictions, 2, sd)
p_response_dfl <- response_disturbance %>%
mutate(type = factor(type, labels =  c("Press", "Pulse"))) %>%
mutate(extent = factor(extent, labels =  c("Small extent (10%)", "Large extent (50%)"))) %>%
split(list(.$type, .$extent)) %>%
map(~ data.frame(count = 1:2,
prop = dpois(x = 1:2, lambda = .$mean / length(1986:2018)),
prop_lwr = dpois(x = 1:2, lambda = (.$mean - .$sd) / length(1986:2018)),
prop_upr = dpois(x = 1:2, lambda = (.$mean + .$sd) / length(1986:2018)))) %>%
bind_rows(.id = "id") %>%
separate("id", c("type", "extent"), "\\.") %>%
mutate(count = factor(count, labels =  c("One event", "Two events"))) %>%
mutate(type = factor(type, levels =  c("Press", "Pulse"))) %>%
mutate(extent = factor(extent, levels =  c("Large extent (50%)", "Small extent (10%)"))) %>%
ggplot(., aes(x = type, y = prop, fill = extent)) +
geom_bar(stat = "identity", position = "dodge",  width = 0.3) +
geom_errorbar(aes(ymin = prop_lwr, ymax = prop_upr), position = position_dodge(width = 0.9), width = 0.25) +
theme_bw() +
theme(legend.background = element_blank(),
legend.position = c(1, 1),
legend.justification = c(1, 1),
legend.text = element_text(size = 9),
panel.grid = element_blank(),
strip.background = element_blank(),
plot.title = element_text(size = 11)) +
labs(x = "Number of events", y = bquote("Probability of occurrence (%"*yr^-1*")"),
fill = NULL, title = "a) Debris flow") +
scale_fill_brewer(palette = "Set1") +
facet_wrap(~count, scales = "free") +
scale_y_continuous(labels = function(x) round(x * 100, 3))
response_disturbance <- expand.grid(eco_region = factor(1),
h_mean = 0,
Circularit = 0,
Elongation = 0,
artifical = 0,
area = 0,
patchdensity = 0,
forest = 0,
Elevation = 0,
Melton = 0,
extent = 0,
type = c(quantile(data_model$type, 0.05), quantile(data_model$type, 0.95)))  # viele EZGs haben Pulisty kleiner als -1
predictions <- final_models[[2]] %>%
posterior_linpred(., newdata = response_disturbance, transform = TRUE)
response_disturbance[, "mean"] <- apply(predictions, 2, mean)
response_disturbance[, "sd"] <- apply(predictions, 2, sd)
p_response_fst <- response_disturbance %>%
mutate(type = factor(type, labels =  c("Press", "Pulse"))) %>%
split(.$type) %>%
map(~ data.frame(count = 1:2,
prop = dpois(x = 1:2, lambda = .$mean / length(1986:2018)),
prop_lwr = dpois(x = 1:2, lambda = (.$mean - .$sd) / length(1986:2018)),
prop_upr = dpois(x = 1:2, lambda = (.$mean + .$sd) / length(1986:2018)))) %>%
bind_rows(.id = "type") %>%
mutate(count = factor(count, labels =  c("One event", "Two events"))) %>%
mutate(type = factor(type, levels =  c("Press", "Pulse"))) %>%
ggplot(., aes(x = type, y = prop)) +
geom_bar(stat = "identity", position = "dodge",  width = 0.6) +
geom_errorbar(aes(ymin = prop_lwr, ymax = prop_upr), position = position_dodge(width = 0.9), width = 0.25) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
plot.title = element_text(size = 11)) +
labs(x = "Number of events", y = bquote("Probability of occurrence (%"*yr^-1*")"),
fill = "Disturbance type", title = "b) Flood") +
scale_fill_brewer(palette = "Set1") +
facet_wrap(~count, scales = "free") +
guides(fill = guide_legend(ncol = 1,
keywidth = 0.15,
keyheight = 0.1,
default.unit = "inch")) +
scale_y_continuous(labels = function(x) round(x * 100, 3))
p_response <- p_response_dfl + p_response_fst + plot_layout(ncol = 2)
p_response
response_disturbance <- expand.grid(eco_region = factor(1),
h_mean = 0,
Circularit = 0,
Elongation = 0,
artifical = 0,
area = 0,
patchdensity = 0,
forest = 0,
Elevation = 0,
Melton = 0,
extent = c((0.5 - mean(data$extent)) / sd(data$extent),
(0.1 - mean(data$extent)) / sd(data$extent)),
type = c(quantile(data_model$type, 0.05), quantile(data_model$type, 0.95)))  # viele EZGs haben Pulisty kleiner als -1
predictions <- final_models[[1]] %>%
posterior_linpred(., newdata = response_disturbance, transform = TRUE)
response_disturbance[, "mean"] <- apply(predictions, 2, mean)
response_disturbance[, "sd"] <- apply(predictions, 2, sd)
p_response_dfl <- response_disturbance %>%
mutate(type = factor(type, labels =  c("Press", "Pulse"))) %>%
mutate(extent = factor(extent, labels =  c("Small extent (10%)", "Large extent (50%)"))) %>%
split(list(.$type, .$extent)) %>%
map(~ data.frame(count = 1:2,
prop = dpois(x = 1:2, lambda = .$mean / length(1986:2018)),
prop_lwr = dpois(x = 1:2, lambda = (.$mean - .$sd) / length(1986:2018)),
prop_upr = dpois(x = 1:2, lambda = (.$mean + .$sd) / length(1986:2018)))) %>%
bind_rows(.id = "id") %>%
separate("id", c("type", "extent"), "\\.") %>%
mutate(count = factor(count, labels =  c("One event", "Two events"))) %>%
mutate(type = factor(type, levels =  c("Press", "Pulse"))) %>%
mutate(extent = factor(extent, levels =  c("Large extent (50%)", "Small extent (10%)"))) %>%
ggplot(., aes(x = type, y = prop, fill = extent)) +
geom_bar(stat = "identity", position = "dodge",  width = 0.5) +
geom_errorbar(aes(ymin = prop_lwr, ymax = prop_upr), position = position_dodge(width = 0.9), width = 0.25) +
theme_bw() +
theme(legend.background = element_blank(),
legend.position = c(1, 1),
legend.justification = c(1, 1),
legend.text = element_text(size = 9),
panel.grid = element_blank(),
strip.background = element_blank(),
plot.title = element_text(size = 11)) +
labs(x = "Number of events", y = bquote("Probability of occurrence (%"*yr^-1*")"),
fill = NULL, title = "a) Debris flow") +
scale_fill_brewer(palette = "Set1") +
facet_wrap(~count, scales = "free") +
scale_y_continuous(labels = function(x) round(x * 100, 3))
response_disturbance <- expand.grid(eco_region = factor(1),
h_mean = 0,
Circularit = 0,
Elongation = 0,
artifical = 0,
area = 0,
patchdensity = 0,
forest = 0,
Elevation = 0,
Melton = 0,
extent = 0,
type = c(quantile(data_model$type, 0.05), quantile(data_model$type, 0.95)))  # viele EZGs haben Pulisty kleiner als -1
predictions <- final_models[[2]] %>%
posterior_linpred(., newdata = response_disturbance, transform = TRUE)
response_disturbance[, "mean"] <- apply(predictions, 2, mean)
response_disturbance[, "sd"] <- apply(predictions, 2, sd)
p_response_fst <- response_disturbance %>%
mutate(type = factor(type, labels =  c("Press", "Pulse"))) %>%
split(.$type) %>%
map(~ data.frame(count = 1:2,
prop = dpois(x = 1:2, lambda = .$mean / length(1986:2018)),
prop_lwr = dpois(x = 1:2, lambda = (.$mean - .$sd) / length(1986:2018)),
prop_upr = dpois(x = 1:2, lambda = (.$mean + .$sd) / length(1986:2018)))) %>%
bind_rows(.id = "type") %>%
mutate(count = factor(count, labels =  c("One event", "Two events"))) %>%
mutate(type = factor(type, levels =  c("Press", "Pulse"))) %>%
ggplot(., aes(x = type, y = prop)) +
geom_bar(stat = "identity", position = "dodge",  width = 0.5) +
geom_errorbar(aes(ymin = prop_lwr, ymax = prop_upr), position = position_dodge(width = 0.9), width = 0.25) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
plot.title = element_text(size = 11)) +
labs(x = "Number of events", y = bquote("Probability of occurrence (%"*yr^-1*")"),
fill = "Disturbance type", title = "b) Flood") +
scale_fill_brewer(palette = "Set1") +
facet_wrap(~count, scales = "free") +
guides(fill = guide_legend(ncol = 1,
keywidth = 0.15,
keyheight = 0.1,
default.unit = "inch")) +
scale_y_continuous(labels = function(x) round(x * 100, 3))
p_response <- p_response_dfl + p_response_fst + plot_layout(ncol = 2)
p_response
p_response_fst <- response_disturbance %>%
mutate(type = factor(type, labels =  c("Press", "Pulse"))) %>%
split(.$type) %>%
map(~ data.frame(count = 1:2,
prop = dpois(x = 1:2, lambda = .$mean / length(1986:2018)),
prop_lwr = dpois(x = 1:2, lambda = (.$mean - .$sd) / length(1986:2018)),
prop_upr = dpois(x = 1:2, lambda = (.$mean + .$sd) / length(1986:2018)))) %>%
bind_rows(.id = "type") %>%
mutate(count = factor(count, labels =  c("One event", "Two events"))) %>%
mutate(type = factor(type, levels =  c("Press", "Pulse"))) %>%
ggplot(., aes(x = type, y = prop)) +
geom_bar(stat = "identity", position = "dodge",  width = 0.25) +
geom_errorbar(aes(ymin = prop_lwr, ymax = prop_upr), position = position_dodge(width = 0.9), width = 0.25) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
plot.title = element_text(size = 11)) +
labs(x = "Number of events", y = bquote("Probability of occurrence (%"*yr^-1*")"),
fill = "Disturbance type", title = "b) Flood") +
scale_fill_brewer(palette = "Set1") +
facet_wrap(~count, scales = "free") +
guides(fill = guide_legend(ncol = 1,
keywidth = 0.15,
keyheight = 0.1,
default.unit = "inch")) +
scale_y_continuous(labels = function(x) round(x * 100, 3))
p_response <- p_response_dfl + p_response_fst + plot_layout(ncol = 2)
p_response
p_response_fst <- response_disturbance %>%
mutate(type = factor(type, labels =  c("Press", "Pulse"))) %>%
split(.$type) %>%
map(~ data.frame(count = 1:2,
prop = dpois(x = 1:2, lambda = .$mean / length(1986:2018)),
prop_lwr = dpois(x = 1:2, lambda = (.$mean - .$sd) / length(1986:2018)),
prop_upr = dpois(x = 1:2, lambda = (.$mean + .$sd) / length(1986:2018)))) %>%
bind_rows(.id = "type") %>%
mutate(count = factor(count, labels =  c("One event", "Two events"))) %>%
mutate(type = factor(type, levels =  c("Press", "Pulse"))) %>%
ggplot(., aes(x = type, y = prop)) +
geom_bar(stat = "identity", position = "dodge",  width = 0.25) +
geom_errorbar(aes(ymin = prop_lwr, ymax = prop_upr), width = 0.125) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
plot.title = element_text(size = 11)) +
labs(x = "Number of events", y = bquote("Probability of occurrence (%"*yr^-1*")"),
fill = "Disturbance type", title = "b) Flood") +
scale_fill_brewer(palette = "Set1") +
facet_wrap(~count, scales = "free") +
guides(fill = guide_legend(ncol = 1,
keywidth = 0.15,
keyheight = 0.1,
default.unit = "inch")) +
scale_y_continuous(labels = function(x) round(x * 100, 3))
p_response_fst
response_disturbance <- expand.grid(eco_region = factor(1),
h_mean = 0,
Circularit = 0,
Elongation = 0,
artifical = 0,
area = 0,
patchdensity = 0,
forest = 0,
Elevation = 0,
Melton = 0,
extent = c((0.5 - mean(data$extent)) / sd(data$extent),
(0.1 - mean(data$extent)) / sd(data$extent)),
type = c(quantile(data_model$type, 0.05), quantile(data_model$type, 0.95)))  # viele EZGs haben Pulisty kleiner als -1
predictions <- final_models[[1]] %>%
posterior_linpred(., newdata = response_disturbance, transform = TRUE)
response_disturbance[, "mean"] <- apply(predictions, 2, mean)
response_disturbance[, "sd"] <- apply(predictions, 2, sd)
p_response_dfl <- response_disturbance %>%
mutate(type = factor(type, labels =  c("Press", "Pulse"))) %>%
mutate(extent = factor(extent, labels =  c("Small extent (10%)", "Large extent (50%)"))) %>%
split(list(.$type, .$extent)) %>%
map(~ data.frame(count = 1:2,
prop = dpois(x = 1:2, lambda = .$mean / length(1986:2018)),
prop_lwr = dpois(x = 1:2, lambda = (.$mean - .$sd) / length(1986:2018)),
prop_upr = dpois(x = 1:2, lambda = (.$mean + .$sd) / length(1986:2018)))) %>%
bind_rows(.id = "id") %>%
separate("id", c("type", "extent"), "\\.") %>%
mutate(count = factor(count, labels =  c("One event", "Two events"))) %>%
mutate(type = factor(type, levels =  c("Press", "Pulse"))) %>%
mutate(extent = factor(extent, levels =  c("Large extent (50%)", "Small extent (10%)"))) %>%
ggplot(., aes(x = type, y = prop, fill = extent)) +
geom_bar(stat = "identity", position = "dodge",  width = 0.5) +
geom_errorbar(aes(ymin = prop_lwr, ymax = prop_upr), position = position_dodge(width = 0.9), width = 0.25) +
theme_bw() +
theme(legend.background = element_blank(),
legend.position = c(1, 1),
legend.justification = c(1, 1),
legend.text = element_text(size = 9),
panel.grid = element_blank(),
strip.background = element_blank(),
plot.title = element_text(size = 11)) +
labs(x = "Number of events", y = bquote("Probability of occurrence (%"*yr^-1*")"),
fill = NULL, title = "a) Debris flow") +
scale_fill_brewer(palette = "Set1") +
facet_wrap(~count, scales = "free") +
scale_y_continuous(labels = function(x) round(x * 100, 3))
p_response_dfl <- response_disturbance %>%
mutate(type = factor(type, labels =  c("Press", "Pulse"))) %>%
mutate(extent = factor(extent, labels =  c("Small extent (10%)", "Large extent (50%)"))) %>%
split(list(.$type, .$extent)) %>%
map(~ data.frame(count = 1:2,
prop = dpois(x = 1:2, lambda = .$mean / length(1986:2018)),
prop_lwr = dpois(x = 1:2, lambda = (.$mean - .$sd) / length(1986:2018)),
prop_upr = dpois(x = 1:2, lambda = (.$mean + .$sd) / length(1986:2018)))) %>%
bind_rows(.id = "id") %>%
separate("id", c("type", "extent"), "\\.") %>%
mutate(count = factor(count, labels =  c("One event", "Two events"))) %>%
mutate(type = factor(type, levels =  c("Press", "Pulse"))) %>%
mutate(extent = factor(extent, levels =  c("Large extent (50%)", "Small extent (10%)"))) %>%
ggplot(., aes(x = type, y = prop, fill = extent)) +
geom_bar(stat = "identity", position = "dodge",  width = 0.5) +
geom_errorbar(aes(ymin = prop_lwr, ymax = prop_upr), position = position_dodge(width = 0.45), width = 0.125) +
theme_bw() +
theme(legend.background = element_blank(),
legend.position = c(1, 1),
legend.justification = c(1, 1),
legend.text = element_text(size = 9),
panel.grid = element_blank(),
strip.background = element_blank(),
plot.title = element_text(size = 11)) +
labs(x = "Number of events", y = bquote("Probability of occurrence (%"*yr^-1*")"),
fill = NULL, title = "a) Debris flow") +
scale_fill_brewer(palette = "Set1") +
facet_wrap(~count, scales = "free") +
scale_y_continuous(labels = function(x) round(x * 100, 3))
p_response_dfl
p_response_dfl <- response_disturbance %>%
mutate(type = factor(type, labels =  c("Press", "Pulse"))) %>%
mutate(extent = factor(extent, labels =  c("Small extent (10%)", "Large extent (50%)"))) %>%
split(list(.$type, .$extent)) %>%
map(~ data.frame(count = 1:2,
prop = dpois(x = 1:2, lambda = .$mean / length(1986:2018)),
prop_lwr = dpois(x = 1:2, lambda = (.$mean - .$sd) / length(1986:2018)),
prop_upr = dpois(x = 1:2, lambda = (.$mean + .$sd) / length(1986:2018)))) %>%
bind_rows(.id = "id") %>%
separate("id", c("type", "extent"), "\\.") %>%
mutate(count = factor(count, labels =  c("One event", "Two events"))) %>%
mutate(type = factor(type, levels =  c("Press", "Pulse"))) %>%
mutate(extent = factor(extent, levels =  c("Large extent (50%)", "Small extent (10%)"))) %>%
ggplot(., aes(x = type, y = prop, fill = extent)) +
geom_bar(stat = "identity", position = "dodge",  width = 0.5) +
geom_errorbar(aes(ymin = prop_lwr, ymax = prop_upr), position = position_dodge(width = 0.45), width = 0.125) +
theme_bw() +
theme(legend.background = element_blank(),
legend.position = c(1, 1),
legend.justification = c(1, 1),
legend.text = element_text(size = 9),
panel.grid = element_blank(),
strip.background = element_blank(),
plot.title = element_text(size = 11)) +
labs(x = "Number of events", y = bquote("Probability of occurrence (%"*yr^-1*")"),
fill = NULL, title = "a) Debris flow") +
scale_fill_brewer(palette = "Set1") +
facet_wrap(~count, scales = "free") +
scale_y_continuous(labels = function(x) round(x * 100, 3))
p_response <- p_response_dfl + p_response_fst + plot_layout(ncol = 2)
p_response
7.5 / 4
ggsave("expected_counts.pdf", p_response, path = "../results/count/", width = 7.5, height = 2)
ggsave("expected_counts.pdf", p_response, path = "../results/count/", width = 7.5, height = 3.5)
p_response <- p_response_dfl + p_response_fst + plot_layout(ncol = 1)
ggsave("expected_counts.pdf", p_response, path = "../results/count/", width = 5.5, height = 5.5)
response_disturbance <- expand.grid(eco_region = factor(1),
h_mean = 0,
Circularit = 0,
Elongation = 0,
artifical = 0,
area = 0,
patchdensity = 0,
forest = 0,
Elevation = 0,
Melton = 0,
extent = c((0.5 - mean(data$extent)) / sd(data$extent),
(0.1 - mean(data$extent)) / sd(data$extent)),
type = c(quantile(data_model$type, 0.05), quantile(data_model$type, 0.95)))  # viele EZGs haben Pulisty kleiner als -1
predictions <- final_models[[1]] %>%
posterior_linpred(., newdata = response_disturbance, transform = TRUE)
response_disturbance[, "mean"] <- apply(predictions, 2, mean)
response_disturbance[, "sd"] <- apply(predictions, 2, sd)
p_response_dfl <- response_disturbance %>%
mutate(type = factor(type, labels =  c("Press", "Pulse"))) %>%
mutate(extent = factor(extent, labels =  c("Small extent (10%)", "Large extent (50%)"))) %>%
split(list(.$type, .$extent)) %>%
map(~ data.frame(count = 1:2,
prop = dpois(x = 1:2, lambda = .$mean / length(1986:2018)),
prop_lwr = dpois(x = 1:2, lambda = (.$mean - .$sd) / length(1986:2018)),
prop_upr = dpois(x = 1:2, lambda = (.$mean + .$sd) / length(1986:2018)))) %>%
bind_rows(.id = "id") %>%
separate("id", c("type", "extent"), "\\.") %>%
mutate(count = factor(count, labels =  c("One event", "Two events"))) %>%
mutate(type = factor(type, levels =  c("Press", "Pulse"))) %>%
mutate(extent = factor(extent, levels =  c("Large extent (50%)", "Small extent (10%)"))) %>%
ggplot(., aes(x = type, y = prop, fill = extent)) +
geom_bar(stat = "identity", position = "dodge",  width = 0.5) +
geom_errorbar(aes(ymin = prop_lwr, ymax = prop_upr), position = position_dodge(width = 0.45), width = 0.125) +
theme_bw() +
theme(legend.background = element_blank(),
legend.position = "right",
legend.justification = c(1, 1),
#legend.text = element_text(size = 9),
panel.grid = element_blank(),
strip.background = element_blank(),
plot.title = element_text(size = 11)) +
labs(x = "Disturbance type", y = bquote("Probability of occurrence (%"*yr^-1*")"),
fill = NULL, title = "a) Debris flow") +
scale_fill_brewer(palette = "Set1") +
facet_wrap(~count, scales = "free") +
scale_y_continuous(labels = function(x) round(x * 100, 3))
response_disturbance <- expand.grid(eco_region = factor(1),
h_mean = 0,
Circularit = 0,
Elongation = 0,
artifical = 0,
area = 0,
patchdensity = 0,
forest = 0,
Elevation = 0,
Melton = 0,
extent = 0,
type = c(quantile(data_model$type, 0.05), quantile(data_model$type, 0.95)))  # viele EZGs haben Pulisty kleiner als -1
predictions <- final_models[[2]] %>%
posterior_linpred(., newdata = response_disturbance, transform = TRUE)
response_disturbance[, "mean"] <- apply(predictions, 2, mean)
response_disturbance[, "sd"] <- apply(predictions, 2, sd)
p_response_fst <- response_disturbance %>%
mutate(type = factor(type, labels =  c("Press", "Pulse"))) %>%
split(.$type) %>%
map(~ data.frame(count = 1:2,
prop = dpois(x = 1:2, lambda = .$mean / length(1986:2018)),
prop_lwr = dpois(x = 1:2, lambda = (.$mean - .$sd) / length(1986:2018)),
prop_upr = dpois(x = 1:2, lambda = (.$mean + .$sd) / length(1986:2018)))) %>%
bind_rows(.id = "type") %>%
mutate(count = factor(count, labels =  c("One event", "Two events"))) %>%
mutate(type = factor(type, levels =  c("Press", "Pulse"))) %>%
ggplot(., aes(x = type, y = prop)) +
geom_bar(stat = "identity", position = "dodge",  width = 0.25) +
geom_errorbar(aes(ymin = prop_lwr, ymax = prop_upr), width = 0.125) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
plot.title = element_text(size = 11)) +
labs(x = "Disturbance type", y = bquote("Probability of occurrence (%"*yr^-1*")"),
title = "b) Flood") +
scale_fill_brewer(palette = "Set1") +
facet_wrap(~count, scales = "free") +
guides(fill = guide_legend(ncol = 1,
keywidth = 0.15,
keyheight = 0.1,
default.unit = "inch")) +
scale_y_continuous(labels = function(x) round(x * 100, 3))
p_response <- p_response_dfl + p_response_fst + plot_layout(ncol = 1)
ggsave("expected_counts.pdf", p_response, path = "../results/count/", width = 5.5, height = 5.5)
ggsave("expected_counts.pdf", p_response, path = "../results/count/", width = 7.5, height = 5.5)
ggsave("expected_counts.pdf", p_response, path = "../results/count/", width = 7, height = 5.5)
ggsave("expected_counts.pdf", p_response, path = "../results/count/", width = 7, height = 5.5)
p_response_fst <- response_disturbance %>%
mutate(type = factor(type, labels =  c("Press", "Pulse"))) %>%
split(.$type) %>%
map(~ data.frame(count = 1:2,
prop = dpois(x = 1:2, lambda = .$mean / length(1986:2018)),
prop_lwr = dpois(x = 1:2, lambda = (.$mean - .$sd) / length(1986:2018)),
prop_upr = dpois(x = 1:2, lambda = (.$mean + .$sd) / length(1986:2018)))) %>%
bind_rows(.id = "type") %>%
mutate(count = factor(count, labels =  c("One event", "Two events"))) %>%
mutate(type = factor(type, levels =  c("Press", "Pulse"))) %>%
ggplot(., aes(x = type, y = prop)) +
geom_bar(stat = "identity", position = "dodge",  width = 0.5) +
geom_errorbar(aes(ymin = prop_lwr, ymax = prop_upr), width = 0.125) +
theme_bw() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
plot.title = element_text(size = 11)) +
labs(x = "Disturbance type", y = bquote("Probability of occurrence (%"*yr^-1*")"),
title = "b) Flood") +
scale_fill_brewer(palette = "Set1") +
facet_wrap(~count, scales = "free") +
guides(fill = guide_legend(ncol = 1,
keywidth = 0.15,
keyheight = 0.1,
default.unit = "inch")) +
scale_y_continuous(labels = function(x) round(x * 100, 3))
p_response <- p_response_dfl + p_response_fst + plot_layout(ncol = 1)
ggsave("expected_counts.pdf", p_response, path = "../results/count/", width = 7, height = 5.5)
