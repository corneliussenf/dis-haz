scale_alpha(breaks = c(0, 0.25, 0.5, 0.75, 1), labels = c("Low", "", "", "", "High")) +
theme(legend.position = "bottom",
legend.box = "vertical",
panel.grid = element_blank(),
strip.background = element_blank(),
plot.margin = element_blank()) +
guides(fill = guide_colorbar(barwidth = 10, barheight = 0.5,
direction = "horizontal", title.position = "top"),
alpha = guide_legend(barwidth = 10, barheight = 0.5,
direction = "horizontal", title.position = "top",
label.position = "bottom"))
map_diff <- shape %>%
sample_n(100) %>%
ggplot(.) +
geom_sf(aes(fill = pred_diff), color = NA, size = 0.2) +
coord_sf(datum = NA) +
scale_fill_gradient2(limits = c(-0.2, 0.2), low = scales::muted("blue"), high = scales::muted("red")) +
scale_x_continuous(expand=c(0,0)) +
scale_y_continuous(expand=c(0,0)) +
labs(x = NULL, y = NULL, fill = paste0("Difference in probability when\nincluding disturbances")) +
ggthemes::theme_map() +
scale_alpha(breaks = c(0, 0.25, 0.5, 0.75, 1), labels = c("Low", "", "", "", "High")) +
theme(legend.position = "top",
legend.box = "vertical",
panel.grid = element_blank(),
strip.background = element_blank(),
plot.margin = element_blank()) +
guides(fill = guide_colorbar(barwidth = 10, barheight = 0.5,
direction = "horizontal", title.position = "top"))
map <- gridExtra::grid.arrange(map_prop, map_diff, ncol = 1)
map_prop <- shape %>%
sample_n(100) %>%
mutate(pred = ifelse(pred >= pred_cutoff, pred_cutoff, pred),
varcof = ifelse(varcof >= varcof_cutoff, varcof_cutoff, varcof)) %>%
ggplot(.) +
geom_sf(aes(fill = pred, alpha = normalize((varcof^2 * -1), na.rm = TRUE)), color = NA, size = 0.2) +
coord_sf(datum = NA) +
scale_fill_gradient(low = "#fff5f0", high = "#67000d") +
scale_x_continuous(expand=c(0,0)) +
scale_y_continuous(expand=c(0,0)) +
labs(x = NULL, y = NULL, fill = paste0("Probability of ", processes[i]), alpha = "Certainty") +
ggthemes::theme_map() +
scale_alpha(breaks = c(0, 0.25, 0.5, 0.75, 1), labels = c("Low", "", "", "", "High")) +
theme(legend.position = "bottom",
legend.box = "vertical",
panel.grid = element_blank(),
strip.background = element_blank(),
plot.margin = unit(c(0, 0, 0, 0), "null")) +
guides(fill = guide_colorbar(barwidth = 10, barheight = 0.5,
direction = "horizontal", title.position = "top"),
alpha = guide_legend(barwidth = 10, barheight = 0.5,
direction = "horizontal", title.position = "top",
label.position = "bottom"))
map_diff <- shape %>%
sample_n(100) %>%
ggplot(.) +
geom_sf(aes(fill = pred_diff), color = NA, size = 0.2) +
coord_sf(datum = NA) +
scale_fill_gradient2(limits = c(-0.2, 0.2), low = scales::muted("blue"), high = scales::muted("red")) +
scale_x_continuous(expand=c(0,0)) +
scale_y_continuous(expand=c(0,0)) +
labs(x = NULL, y = NULL, fill = paste0("Difference in probability when\nincluding disturbances")) +
ggthemes::theme_map() +
scale_alpha(breaks = c(0, 0.25, 0.5, 0.75, 1), labels = c("Low", "", "", "", "High")) +
theme(legend.position = "top",
legend.box = "vertical",
panel.grid = element_blank(),
strip.background = element_blank(),
plot.margin = unit(c(0, 0, 0, 0), "null")) +
guides(fill = guide_colorbar(barwidth = 10, barheight = 0.5,
direction = "horizontal", title.position = "top"))
map <- gridExtra::grid.arrange(map_prop, map_diff, ncol = 1)
map_prop <- shape %>%
sample_n(500) %>%
mutate(pred = ifelse(pred >= pred_cutoff, pred_cutoff, pred),
varcof = ifelse(varcof >= varcof_cutoff, varcof_cutoff, varcof)) %>%
ggplot(.) +
geom_sf(aes(fill = pred, alpha = normalize((varcof^2 * -1), na.rm = TRUE)), color = NA, size = 0.2) +
coord_sf(datum = NA) +
scale_fill_gradient(low = "#fff5f0", high = "#67000d") +
scale_x_continuous(expand=c(0,0)) +
scale_y_continuous(expand=c(0,0)) +
labs(x = NULL, y = NULL, fill = paste0("Probability of ", processes[i]), alpha = "Certainty") +
ggthemes::theme_map() +
scale_alpha(breaks = c(0, 0.25, 0.5, 0.75, 1), labels = c("Low", "", "", "", "High")) +
theme(legend.position = "bottom",
legend.box = "vertical",
panel.grid = element_blank(),
strip.background = element_blank(),
plot.margin = unit(c(0, 0, 0, 0), "null")) +
guides(fill = guide_colorbar(barwidth = 10, barheight = 0.5,
direction = "horizontal", title.position = "top"),
alpha = guide_legend(barwidth = 10, barheight = 0.5,
direction = "horizontal", title.position = "top",
label.position = "bottom"))
map_diff <- shape %>%
sample_n(500) %>%
ggplot(.) +
geom_sf(aes(fill = pred_diff), color = NA, size = 0.2) +
coord_sf(datum = NA) +
scale_fill_gradient2(limits = c(-0.2, 0.2), low = scales::muted("blue"), high = scales::muted("red")) +
scale_x_continuous(expand=c(0,0)) +
scale_y_continuous(expand=c(0,0)) +
labs(x = NULL, y = NULL, fill = paste0("Difference in probability when\nincluding disturbances")) +
ggthemes::theme_map() +
scale_alpha(breaks = c(0, 0.25, 0.5, 0.75, 1), labels = c("Low", "", "", "", "High")) +
theme(legend.position = "top",
legend.box = "vertical",
panel.grid = element_blank(),
strip.background = element_blank(),
plot.margin = unit(c(0, 0, 0, 0), "null")) +
guides(fill = guide_colorbar(barwidth = 10, barheight = 0.5,
direction = "horizontal", title.position = "top"))
map <- gridExtra::grid.arrange(map_prop, map_diff, ncol = 1)
map_prop <- shape %>%
sample_n(50) %>%
mutate(pred = ifelse(pred >= pred_cutoff, pred_cutoff, pred),
varcof = ifelse(varcof >= varcof_cutoff, varcof_cutoff, varcof)) %>%
ggplot(.) +
geom_sf(aes(fill = pred, alpha = normalize((varcof^2 * -1), na.rm = TRUE)), color = NA, size = 0.2) +
coord_sf(datum = NA) +
scale_fill_gradient(low = "#fff5f0", high = "#67000d") +
scale_x_continuous(expand=c(0,0)) +
scale_y_continuous(expand=c(0,0)) +
labs(x = NULL, y = NULL, fill = paste0("Probability of ", processes[i]), alpha = "Certainty") +
ggthemes::theme_map() +
scale_alpha(breaks = c(0, 0.25, 0.5, 0.75, 1), labels = c("Low", "", "", "", "High")) +
theme(legend.position = "bottom",
legend.box = "vertical",
panel.grid = element_blank(),
strip.background = element_blank(),
plot.margin = unit(c(0.5, 0, 0, 0), "null")) +
guides(fill = guide_colorbar(barwidth = 10, barheight = 0.5,
direction = "horizontal", title.position = "top"),
alpha = guide_legend(barwidth = 10, barheight = 0.5,
direction = "horizontal", title.position = "top",
label.position = "bottom"))
map_diff <- shape %>%
sample_n(50) %>%
ggplot(.) +
geom_sf(aes(fill = pred_diff), color = NA, size = 0.2) +
coord_sf(datum = NA) +
scale_fill_gradient2(limits = c(-0.2, 0.2), low = scales::muted("blue"), high = scales::muted("red")) +
scale_x_continuous(expand=c(0,0)) +
scale_y_continuous(expand=c(0,0)) +
labs(x = NULL, y = NULL, fill = paste0("Difference in probability when\nincluding disturbances")) +
ggthemes::theme_map() +
scale_alpha(breaks = c(0, 0.25, 0.5, 0.75, 1), labels = c("Low", "", "", "", "High")) +
theme(legend.position = "top",
legend.box = "vertical",
panel.grid = element_blank(),
strip.background = element_blank(),
plot.margin = unit(c(0.5, 0, 0, 0), "null")) +
guides(fill = guide_colorbar(barwidth = 10, barheight = 0.5,
direction = "horizontal", title.position = "top"))
map <- gridExtra::grid.arrange(map_prop, map_diff, ncol = 1)
map_prop <- shape %>%
sample_n(50) %>%
mutate(pred = ifelse(pred >= pred_cutoff, pred_cutoff, pred),
varcof = ifelse(varcof >= varcof_cutoff, varcof_cutoff, varcof)) %>%
ggplot(.) +
geom_sf(aes(fill = pred, alpha = normalize((varcof^2 * -1), na.rm = TRUE)), color = NA, size = 0.2) +
coord_sf(datum = NA) +
scale_fill_gradient(low = "#fff5f0", high = "#67000d") +
scale_x_continuous(expand=c(0,0)) +
scale_y_continuous(expand=c(0,0)) +
labs(x = NULL, y = NULL, fill = paste0("Probability of ", processes[i]), alpha = "Certainty") +
ggthemes::theme_map() +
scale_alpha(breaks = c(0, 0.25, 0.5, 0.75, 1), labels = c("Low", "", "", "", "High")) +
theme(legend.position = "bottom",
legend.box = "vertical",
panel.grid = element_blank(),
strip.background = element_blank(),
plot.margin = unit(c(0.001, 0, 0, 0), "null")) +
guides(fill = guide_colorbar(barwidth = 10, barheight = 0.5,
direction = "horizontal", title.position = "top"),
alpha = guide_legend(barwidth = 10, barheight = 0.5,
direction = "horizontal", title.position = "top",
label.position = "bottom"))
map_diff <- shape %>%
sample_n(50) %>%
ggplot(.) +
geom_sf(aes(fill = pred_diff), color = NA, size = 0.2) +
coord_sf(datum = NA) +
scale_fill_gradient2(limits = c(-0.2, 0.2), low = scales::muted("blue"), high = scales::muted("red")) +
scale_x_continuous(expand=c(0,0)) +
scale_y_continuous(expand=c(0,0)) +
labs(x = NULL, y = NULL, fill = paste0("Difference in probability when\nincluding disturbances")) +
ggthemes::theme_map() +
scale_alpha(breaks = c(0, 0.25, 0.5, 0.75, 1), labels = c("Low", "", "", "", "High")) +
theme(legend.position = "top",
legend.box = "vertical",
panel.grid = element_blank(),
strip.background = element_blank(),
plot.margin = unit(c(0.001, 0, 0, 0), "null")) +
guides(fill = guide_colorbar(barwidth = 10, barheight = 0.5,
direction = "horizontal", title.position = "top"))
map <- gridExtra::grid.arrange(map_prop, map_diff, ncol = 1)
map_diff <- shape %>%
sample_n(50) %>%
ggplot(.) +
geom_sf(aes(fill = pred_diff), color = NA, size = 0.2) +
coord_sf(datum = NA) +
scale_fill_gradient2(limits = c(-0.2, 0.2), low = scales::muted("blue"), high = scales::muted("red")) +
scale_x_continuous(expand=c(0,0)) +
scale_y_continuous(expand=c(0,0)) +
labs(x = NULL, y = NULL, fill = paste0("Difference in probability when\nincluding disturbances")) +
ggthemes::theme_map() +
scale_alpha(breaks = c(0, 0.25, 0.5, 0.75, 1), labels = c("Low", "", "", "", "High")) +
theme(legend.position = "top",
legend.box = "vertical",
panel.grid = element_blank(),
strip.background = element_blank(),
plot.margin = unit(c(0.01, 0, 0, 0), "null")) +
guides(fill = guide_colorbar(barwidth = 10, barheight = 0.5,
direction = "horizontal", title.position = "top"))
map <- gridExtra::grid.arrange(map_prop, map_diff, ncol = 1)
map_prop <- shape %>%
sample_n(50) %>%
mutate(pred = ifelse(pred >= pred_cutoff, pred_cutoff, pred),
varcof = ifelse(varcof >= varcof_cutoff, varcof_cutoff, varcof)) %>%
ggplot(.) +
geom_sf(aes(fill = pred, alpha = normalize((varcof^2 * -1), na.rm = TRUE)), color = NA, size = 0.2) +
coord_sf(datum = NA) +
scale_fill_gradient(low = "#fff5f0", high = "#67000d") +
scale_x_continuous(expand=c(0,0)) +
scale_y_continuous(expand=c(0,0)) +
labs(x = NULL, y = NULL, fill = paste0("Probability of ", processes[i]), alpha = "Certainty") +
ggthemes::theme_map() +
scale_alpha(breaks = c(0, 0.25, 0.5, 0.75, 1), labels = c("Low", "", "", "", "High")) +
theme(legend.position = "bottom",
legend.box = "vertical",
panel.grid = element_blank(),
strip.background = element_blank(),
plot.margin = unit(c(0.01, 0, 0, 0), "null")) +
guides(fill = guide_colorbar(barwidth = 10, barheight = 0.5,
direction = "horizontal", title.position = "top"),
alpha = guide_legend(barwidth = 10, barheight = 0.5,
direction = "horizontal", title.position = "top",
label.position = "bottom"))
map_diff <- shape %>%
sample_n(50) %>%
ggplot(.) +
geom_sf(aes(fill = pred_diff), color = NA, size = 0.2) +
coord_sf(datum = NA) +
scale_fill_gradient2(limits = c(-0.2, 0.2), low = scales::muted("blue"), high = scales::muted("red")) +
scale_x_continuous(expand=c(0,0)) +
scale_y_continuous(expand=c(0,0)) +
labs(x = NULL, y = NULL, fill = paste0("Difference in probability when\nincluding disturbances")) +
ggthemes::theme_map() +
scale_alpha(breaks = c(0, 0.25, 0.5, 0.75, 1), labels = c("Low", "", "", "", "High")) +
theme(legend.position = "top",
legend.box = "vertical",
panel.grid = element_blank(),
strip.background = element_blank(),
plot.margin = unit(c(0.01, 0, 0, 0), "null")) +
guides(fill = guide_colorbar(barwidth = 10, barheight = 0.5,
direction = "horizontal", title.position = "top"))
map <- gridExtra::grid.arrange(map_prop, map_diff, ncol = 1)
map_prop <- shape %>%
sample_n(50) %>%
mutate(pred = ifelse(pred >= pred_cutoff, pred_cutoff, pred),
varcof = ifelse(varcof >= varcof_cutoff, varcof_cutoff, varcof)) %>%
ggplot(.) +
geom_sf(aes(fill = pred, alpha = normalize((varcof^2 * -1), na.rm = TRUE)), color = NA, size = 0.2) +
coord_sf(datum = NA) +
scale_fill_gradient(low = "#fff5f0", high = "#67000d") +
scale_x_continuous(expand=c(0,0)) +
scale_y_continuous(expand=c(0,0)) +
labs(x = NULL, y = NULL, fill = paste0("Probability of ", processes[i]), alpha = "Certainty") +
ggthemes::theme_map() +
scale_alpha(breaks = c(0, 0.25, 0.5, 0.75, 1), labels = c("Low", "", "", "", "High")) +
theme(legend.position = "bottom",
legend.box = "vertical",
panel.grid = element_blank(),
strip.background = element_blank(),
plot.margin = unit(c(0.02, 0, 0, 0), "null")) +
guides(fill = guide_colorbar(barwidth = 10, barheight = 0.5,
direction = "horizontal", title.position = "top"),
alpha = guide_legend(barwidth = 10, barheight = 0.5,
direction = "horizontal", title.position = "top",
label.position = "bottom"))
map_diff <- shape %>%
sample_n(50) %>%
ggplot(.) +
geom_sf(aes(fill = pred_diff), color = NA, size = 0.2) +
coord_sf(datum = NA) +
scale_fill_gradient2(limits = c(-0.2, 0.2), low = scales::muted("blue"), high = scales::muted("red")) +
scale_x_continuous(expand=c(0,0)) +
scale_y_continuous(expand=c(0,0)) +
labs(x = NULL, y = NULL, fill = paste0("Difference in probability when\nincluding disturbances")) +
ggthemes::theme_map() +
scale_alpha(breaks = c(0, 0.25, 0.5, 0.75, 1), labels = c("Low", "", "", "", "High")) +
theme(legend.position = "top",
legend.box = "vertical",
panel.grid = element_blank(),
strip.background = element_blank(),
plot.margin = unit(c(0.02, 0, 0, 0), "null")) +
guides(fill = guide_colorbar(barwidth = 10, barheight = 0.5,
direction = "horizontal", title.position = "top"))
map <- gridExtra::grid.arrange(map_prop, map_diff, ncol = 1)
map_prop <- shape %>%
#sample_n(50) %>%
mutate(pred = ifelse(pred >= pred_cutoff, pred_cutoff, pred),
varcof = ifelse(varcof >= varcof_cutoff, varcof_cutoff, varcof)) %>%
ggplot(.) +
geom_sf(aes(fill = pred, alpha = normalize((varcof^2 * -1), na.rm = TRUE)), color = NA, size = 0.2) +
coord_sf(datum = NA) +
scale_fill_gradient(low = "#fff5f0", high = "#67000d") +
scale_x_continuous(expand=c(0,0)) +
scale_y_continuous(expand=c(0,0)) +
labs(x = NULL, y = NULL, fill = paste0("Probability of ", processes[i]), alpha = "Certainty") +
ggthemes::theme_map() +
scale_alpha(breaks = c(0, 0.25, 0.5, 0.75, 1), labels = c("Low", "", "", "", "High")) +
theme(legend.position = "bottom",
legend.box = "vertical",
panel.grid = element_blank(),
strip.background = element_blank(),
plot.margin = unit(c(0.02, 0, 0, 0), "null")) +
guides(fill = guide_colorbar(barwidth = 10, barheight = 0.5,
direction = "horizontal", title.position = "top"),
alpha = guide_legend(barwidth = 10, barheight = 0.5,
direction = "horizontal", title.position = "top",
label.position = "bottom"))
map_diff <- shape %>%
#sample_n(50) %>%
ggplot(.) +
geom_sf(aes(fill = pred_diff), color = NA, size = 0.2) +
coord_sf(datum = NA) +
scale_fill_gradient2(limits = c(-0.2, 0.2), low = scales::muted("blue"), high = scales::muted("red")) +
scale_x_continuous(expand=c(0,0)) +
scale_y_continuous(expand=c(0,0)) +
labs(x = NULL, y = NULL, fill = paste0("Difference in probability when\nincluding disturbances")) +
ggthemes::theme_map() +
scale_alpha(breaks = c(0, 0.25, 0.5, 0.75, 1), labels = c("Low", "", "", "", "High")) +
theme(legend.position = "top",
legend.box = "vertical",
panel.grid = element_blank(),
strip.background = element_blank(),
plot.margin = unit(c(0.02, 0, 0, 0), "null")) +
guides(fill = guide_colorbar(barwidth = 10, barheight = 0.5,
direction = "horizontal", title.position = "top"))
map <- gridExtra::grid.arrange(map_prop, map_diff, ncol = 1)
map_prop <- shape %>%
sample_n(50) %>%
mutate(pred = ifelse(pred >= pred_cutoff, pred_cutoff, pred),
varcof = ifelse(varcof >= varcof_cutoff, varcof_cutoff, varcof)) %>%
ggplot(.) +
geom_sf(aes(fill = pred, alpha = normalize((varcof^2 * -1), na.rm = TRUE)), color = NA, size = 0.2) +
coord_sf(datum = NA) +
scale_fill_gradient(low = "#fff5f0", high = "#67000d") +
scale_x_continuous(expand=c(0,0)) +
scale_y_continuous(expand=c(0,0)) +
labs(x = NULL, y = NULL, fill = paste0("Probability of ", processes[i]), alpha = "Certainty") +
ggthemes::theme_map() +
scale_alpha(breaks = c(0, 0.25, 0.5, 0.75, 1), labels = c("Low", "", "", "", "High")) +
theme(legend.position = c(0, 0),
legend.justification = c(0, 0),
legend.box = "vertical",
panel.grid = element_blank(),
strip.background = element_blank(),
plot.margin = unit(c(0, 0, 0, 0), "null")) +
guides(fill = guide_colorbar(barwidth = 10, barheight = 0.5,
direction = "horizontal", title.position = "top"),
alpha = guide_legend(barwidth = 10, barheight = 0.5,
direction = "horizontal", title.position = "top",
label.position = "bottom"))
map_diff <- shape %>%
sample_n(50) %>%
ggplot(.) +
geom_sf(aes(fill = pred_diff), color = NA, size = 0.2) +
coord_sf(datum = NA) +
scale_fill_gradient2(limits = c(-0.2, 0.2), low = scales::muted("blue"), high = scales::muted("red")) +
scale_x_continuous(expand=c(0,0)) +
scale_y_continuous(expand=c(0,0)) +
labs(x = NULL, y = NULL, fill = paste0("Difference in probability when\nincluding disturbances")) +
ggthemes::theme_map() +
scale_alpha(breaks = c(0, 0.25, 0.5, 0.75, 1), labels = c("Low", "", "", "", "High")) +
theme(legend.position = c(0, 1),
legend.justification = c(0, 1),
legend.box = "vertical",
panel.grid = element_blank(),
strip.background = element_blank(),
plot.margin = unit(c(0, 0, 0, 0), "null")) +
guides(fill = guide_colorbar(barwidth = 10, barheight = 0.5,
direction = "horizontal", title.position = "top"))
map <- gridExtra::grid.arrange(map_prop, map_diff, ncol = 1)
map_prop <- shape %>%
sample_n(50) %>%
mutate(pred = ifelse(pred >= pred_cutoff, pred_cutoff, pred),
varcof = ifelse(varcof >= varcof_cutoff, varcof_cutoff, varcof)) %>%
ggplot(.) +
geom_sf(aes(fill = pred, alpha = normalize((varcof^2 * -1), na.rm = TRUE)), color = NA, size = 0.2) +
coord_sf(datum = NA) +
scale_fill_gradient(low = "#fff5f0", high = "#67000d") +
scale_x_continuous(expand=c(0,0)) +
scale_y_continuous(expand=c(0,0)) +
labs(x = NULL, y = NULL, fill = paste0("Probability of ", processes[i]), alpha = "Certainty") +
ggthemes::theme_map() +
scale_alpha(breaks = c(0, 0.25, 0.5, 0.75, 1), labels = c("Low", "", "", "", "High")) +
theme(legend.position = c(0, 0),
legend.justification = c(0, 1),
legend.box = "vertical",
panel.grid = element_blank(),
strip.background = element_blank(),
plot.margin = unit(c(0, 0, 0, 0), "null")) +
guides(fill = guide_colorbar(barwidth = 10, barheight = 0.5,
direction = "horizontal", title.position = "top"),
alpha = guide_legend(barwidth = 10, barheight = 0.5,
direction = "horizontal", title.position = "top",
label.position = "bottom"))
map_diff <- shape %>%
sample_n(50) %>%
ggplot(.) +
geom_sf(aes(fill = pred_diff), color = NA, size = 0.2) +
coord_sf(datum = NA) +
scale_fill_gradient2(limits = c(-0.2, 0.2), low = scales::muted("blue"), high = scales::muted("red")) +
scale_x_continuous(expand=c(0,0)) +
scale_y_continuous(expand=c(0,0)) +
labs(x = NULL, y = NULL, fill = paste0("Difference in probability when\nincluding disturbances")) +
ggthemes::theme_map() +
scale_alpha(breaks = c(0, 0.25, 0.5, 0.75, 1), labels = c("Low", "", "", "", "High")) +
theme(legend.position = c(0, 1),
legend.justification = c(0, 1),
legend.box = "vertical",
panel.grid = element_blank(),
strip.background = element_blank(),
plot.margin = unit(c(0, 0, 0, 0), "null")) +
guides(fill = guide_colorbar(barwidth = 10, barheight = 0.5,
direction = "horizontal", title.position = "top"))
map <- gridExtra::grid.arrange(map_prop, map_diff, ncol = 1)
map_prop <- shape %>%
#sample_n(50) %>%
mutate(pred = ifelse(pred >= pred_cutoff, pred_cutoff, pred),
varcof = ifelse(varcof >= varcof_cutoff, varcof_cutoff, varcof)) %>%
ggplot(.) +
geom_sf(aes(fill = pred, alpha = normalize((varcof^2 * -1), na.rm = TRUE)), color = NA, size = 0.2) +
coord_sf(datum = NA) +
scale_fill_gradient(low = "#fff5f0", high = "#67000d") +
scale_x_continuous(expand=c(0,0)) +
scale_y_continuous(expand=c(0,0)) +
labs(x = NULL, y = NULL, fill = paste0("Probability of ", processes[i]), alpha = "Certainty") +
ggthemes::theme_map() +
scale_alpha(breaks = c(0, 0.25, 0.5, 0.75, 1), labels = c("Low", "", "", "", "High")) +
theme(legend.position = "bottom",
legend.box = "vertical",
panel.grid = element_blank(),
strip.background = element_blank()) +
guides(fill = guide_colorbar(barwidth = 10, barheight = 0.5,
direction = "horizontal", title.position = "top"),
alpha = guide_legend(barwidth = 10, barheight = 0.5,
direction = "horizontal", title.position = "top",
label.position = "bottom"))
map_diff <- shape %>%
#sample_n(50) %>%
ggplot(.) +
geom_sf(aes(fill = pred_diff), color = NA, size = 0.2) +
coord_sf(datum = NA) +
scale_fill_gradient2(limits = c(-0.2, 0.2), low = scales::muted("blue"), high = scales::muted("red")) +
scale_x_continuous(expand=c(0,0)) +
scale_y_continuous(expand=c(0,0)) +
labs(x = NULL, y = NULL, fill = paste0("Difference in probability when\nincluding disturbances")) +
ggthemes::theme_map() +
scale_alpha(breaks = c(0, 0.25, 0.5, 0.75, 1), labels = c("Low", "", "", "", "High")) +
theme(legend.position = "top",
legend.box = "vertical",
panel.grid = element_blank(),
strip.background = element_blank()) +
guides(fill = guide_colorbar(barwidth = 10, barheight = 0.5,
direction = "horizontal", title.position = "top"))
map <- gridExtra::grid.arrange(map_prop, map_diff, ncol = 1)
dev.off()
map_prop <- shape %>%
#sample_n(50) %>%
mutate(pred = ifelse(pred >= pred_cutoff, pred_cutoff, pred),
varcof = ifelse(varcof >= varcof_cutoff, varcof_cutoff, varcof)) %>%
ggplot(.) +
geom_sf(aes(fill = pred, alpha = normalize((varcof^2 * -1), na.rm = TRUE)), color = NA, size = 0.2) +
coord_sf(datum = NA) +
scale_fill_gradient(low = "#fff5f0", high = "#67000d") +
scale_x_continuous(expand=c(0,0)) +
scale_y_continuous(expand=c(0,0)) +
labs(x = NULL, y = NULL, fill = paste0("Probability of ", processes[i]), alpha = "Certainty") +
ggthemes::theme_map() +
scale_alpha(breaks = c(0, 0.25, 0.5, 0.75, 1), labels = c("Low", "", "", "", "High")) +
theme(legend.position = "bottom",
legend.box = "vertical",
panel.grid = element_blank(),
strip.background = element_blank()) +
guides(fill = guide_colorbar(barwidth = 10, barheight = 0.5,
direction = "horizontal", title.position = "top"),
alpha = guide_legend(barwidth = 10, barheight = 0.5,
direction = "horizontal", title.position = "top",
label.position = "bottom"))
map_diff <- shape %>%
#sample_n(50) %>%
ggplot(.) +
geom_sf(aes(fill = pred_diff), color = NA, size = 0.2) +
coord_sf(datum = NA) +
scale_fill_gradient2(limits = c(-0.2, 0.2), low = scales::muted("blue"), high = scales::muted("red")) +
scale_x_continuous(expand=c(0,0)) +
scale_y_continuous(expand=c(0,0)) +
labs(x = NULL, y = NULL, fill = paste0("Difference in probability when\nincluding disturbances")) +
ggthemes::theme_map() +
scale_alpha(breaks = c(0, 0.25, 0.5, 0.75, 1), labels = c("Low", "", "", "", "High")) +
theme(legend.position = "top",
legend.box = "vertical",
panel.grid = element_blank(),
strip.background = element_blank()) +
guides(fill = guide_colorbar(barwidth = 10, barheight = 0.5,
direction = "horizontal", title.position = "top"))
map <- gridExtra::grid.arrange(map_prop, map_diff, ncol = 1)
